language: java
sudo: false
dist: trusty
jdk:
- oraclejdk8
- oraclejdk9
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.m2"
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
before_install:
- openssl aes-256-cbc -K $encrypted_2c5a45ddad64_key -iv $encrypted_2c5a45ddad64_iv
  -in deploy/secring.gpg.enc -out deploy/secring.gpg -d
- openssl aes-256-cbc -K $encrypted_2c5a45ddad64_key -iv $encrypted_2c5a45ddad64_iv
  -in deploy/pubring.gpg.enc -out deploy/pubring.gpg -d
- mvn install:install-file -Dfile=lib/spring-restdocs-core-2.0.2.RELEASE-test.jar
  -DgroupId=org.springframework.restdocs -DartifactId=spring-restdocs-core -Dversion=2.0.2.RELEASE
  -Dpackaging=jar -Dclassifier=test
script:
- mvn install -B -V
- cd samples
- mvn install -B -V
- test "$TRAVIS_JDK_VERSION" = "oraclejdk8" && cd java-webmvc && ./gradlew check &&
  cd .. || (exit 0)
- test "$TRAVIS_JDK_VERSION" = "oraclejdk8" && cd kotlin-webmvc && ./gradlew check
  && cd .. || (exit 0)
after_success:
- cd $TRAVIS_BUILD_DIR
- test "$TRAVIS_BRANCH" = "master" && test "$TRAVIS_PULL_REQUEST" = "false" && test
  "$TRAVIS_JDK_VERSION" = "oraclejdk8" && mvn deploy --settings
  "$DEPLOY_DIR/travis-settings.xml" -DskipTests=true -B -V
- test "$TRAVIS_BRANCH" = "master" && test "$TRAVIS_PULL_REQUEST" = "false" && test
  "$TRAVIS_JDK_VERSION" = "oraclejdk9" && cd spring-auto-restdocs-json-doclet-jdk9
   && mvn deploy --settings "$DEPLOY_DIR/travis-settings.xml" -DskipTests=true -B -V
branches:
  only:
  - master
env:
  global:
  - DEPLOY_DIR="$TRAVIS_BUILD_DIR/deploy"
  - secure: p3fJcvsiONLYJVDz5BAMUmvRBcizFCT3jxnzX9M+943AbK8Aq8LOC3b3wMqQ3MtR0VJYRNgt+KGYm/bXPpoUrvzEsF7+jHD6EdZ1V7/8I759gIfYuewUR/pjJDowDLo/sMHD1o2vp9K/CFBdeBnRzp0DwoAWd3/dJWci4fRXUfjiEACHvm8t1lUdaWcjfLAWlzwmW9rF4YSGrcMPZlfTHRdrdyisbPq++LjOs5GguBZEeYwXD6odmXLu6TKDiBvWtlJYqL4/Xs99vBOdDPb4FjP7Zc8TgOjPRIAFUQR6W+OMokDHpFx/433M6rkrckOBdWUtDN0ieV5hNbrFFdmnDKfJjIjPFjbTw0qfkOBr1QWbZwjMUgKA2opj79pQ3VlxHE4CQUpY+lQNtIisfQdTAj21Y3yRsZyOZ79muTbAyKKdFHNi0k1rDP5J8e+ExhZr3pMxs+f4ldGYnMWhB70Ah+tWG0IV2BYSV4d/+8ZC0UPJzTrK1+yay/ZVj20DqHURs+if3L6jGgzKYr4gXsn3yDlSdJLD/6zOiNqfqMZ7PrghgUAdSGpoSQ71aw3ganmVYjW4w0yW1eGd8VCeBQwSpy6kyscGTsvcA0hvKYUDjw4iPMSboFgmUc8E/JZE/gkufQu8cliGNktd54CxFc5wDysCE3ZR4hxXeKBhoP3XXlA=
  - secure: FnsXkKnWrQqPlf816Pc1iH59v/rEdCYnmHLw21mE0F2rbdUSMBXqHg3CtgXjwOtYdrmdbRcAOGzoUBbTF20alzj4OmMLbYLcqU/aHRDJ8ncc2OToRqk3/t+lXK59pGMq0i3GgGJw88znsiawcYYTAo+a/7ZDU/hCnRLZnqIY/8dEuOCXZTdoJ7BmCbLc/3H2//LpX22bnW9721/30ZHkIUdITvsUTj2uk8mpgdX+y/MBABn+cji5tTuw6Fu49RHvUE4BX6gAI/yLi2RUdpRg0GKxKH9L7WDbwlpWKD7/unXW1uh1qEBdmJ0Vog9aH0Yz56tf0HRt+xddjEzlHK9T49s2+1JvSh6/xTr9OnhuiIkHfX3FJ9ro79ZqsqYOLzdw6bcHdm5emH0nAeUEr2CZemrynaJUjIbhotj3Ht2DXOkoAhC8JkKYsTs8/TkIv7VIhk6ITBuTlTwLoTgqoYKIuVY8YXmXmy61ZDuVUxckC6p8Aizhy+qsIOKgZYykGtV9r/2ST/FxS8ZF6hrAWqYhZlU+oXgaxHRuB0ifw+zDQG2GAGLl7rEhDOddxG7mwXeLAP0IORCyLKfnX9vDuBVrlHRShT6r1flLYEqeZIFrhh/qMIJh+BqoiPeno500gYIyjc2mzm9B4LuZYf3m00qLa84CBS72nZwhspjSB88nYXo=
  - secure: rBuTTXoTZ57KG86Hw0R3wJ/he+I5JXo/TcPN1kcVDfhpTOwiPP3I6m7XCzny5f5idmEp5cV0m5LtgpRhlN2uv3asMcPFzvjG6L3gDJkxds2/1Ff28YNsvOg8efrwmdendjXN7ytc7bNJG0d7LBm4QTjoblP1kD2OfbhCNtTer2oObcu/j1wX5f1+pxezx0eWVOKGxCitiAhe1/f8ypBNZ4lZASc4bXPosdnTWlYvL+IbKMKCniBuYTVcyD312TDlVDD3pF+L9rdsgRXO0lpICWFM/LSo6Ih5Jqy1O5dLd/QfPkBKRP3NFS2inecW4J5J51ASV/8w1assqht4M4UFx9G4n0BTXivv7jHVZZzwC4lRYA3g+Mm+WP49f3i5HLNfjFz1659VaD1BSRGdFDEHPHxp4Fk4xnS3kBvxfsCvFkDZjmU4LFluf6964VltG87WAljdp471he3R0FUPkeLel17H9UNH6wm1SoI8S5vCHgjk/nkOixYwsIC+RSQwXpqPB5BhrCjnOKDS2QLQecrzmzsyb9UtMWcDSTKlhWkG8DmjRu/gA4sQhM0kecb2tjUiKAN7RBUnuyXzPzQinwNAsg0jWZQfNLBbhLdpaHf6/hdlUnLtlCPSHQoet651e++ME/ebmJFwyQ95RHzhldI2wr69FcnUb5qk79iBdjC1JUY=
  - secure: T43svDAUhUNsYfn5UFo8MEhE8EVkWAIpe4K23TaRpfq1xKoiESJAnzNGoyxmPDPzLg/ITj1wUznxrMVGbe7LmW+vmcyTl4zRoAQX/yuhfOmJQkQW9JKC/QuY/SADVoygVR9uwMvWkvsBlgTM3/CZWFRci+KBppYENjnigei8nVnRbNj9zl4wGJYSa5iYS7HNz+SYXhJ8JjLj7TMpvwl+0O70ar9iEDs2Q3VvKeqfBQvZO3YOTrk3b0jED9YHaxqPf0VNVeyxwP5WMsWS6G108RZ3EMQDdqLedoIq/cwhxIMxquA9pG4HqDqAWzpOdDkFBIhqFLVvgoV8pZIy5jorjM32cUNiUlzOF8m4Og3mfbJp2aiipAIqSwwZpv9yNUyXKBzv4wd+9YZU+iObpSRiCKbnXKwMQNBj3SIeDnOznRNdBdL71HAyz2ewpi3mEjVJTdLOVGseRkg7rudm2KrvA9XPcAHfEIoReO6aLxk1aLLPVPXk2RgfjPotLO3iZOMMiFFKSoAFOhms6R8obQ9jNMrrBRjSzCUKjLTq+9WeW6tPV9dzieHyIbkUv5WVrDxzs3VYu3CNj3E1tjJFCr8nF/XLtIi2R97TepRMcuI47NmyqwqhTtMfnCiAR6vcTIMzVEhrCh++Xj3gLu2f1Uv7ilsmNJx+l6T281uTQ1I7axU=
