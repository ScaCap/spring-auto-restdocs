:core-dir: https://github.com/ScaCap/spring-auto-restdocs/blob/master/spring-auto-restdocs-core
:core-package: {core-dir}/src/main/java/capital/scalable/restdocs
:restdocs-package: https://github.com/spring-projects/spring-restdocs/blob/master/spring-restdocs-core/src/main/java/org/springframework/restdocs

[[snippets-section]]
=== Section snippet

The section snippet combines most common snippets into one convenient file.
It helps you being even more lazy, because a single line of AsciiDoc is sufficient to document one endpoint.
Assuming of course that you already documented your code with Javadoc.

.Asciidoc
[source,asciidoc,indent=0,role="secondary"]
----
\include::{snippets}/your-endpoint/section.adoc[]
----

.Template itself
[source,asciidoc,indent=0,role="secondary"]
----
include::{core-dir}/src/main/resources/org/springframework/restdocs/templates/asciidoctor/section.snippet[]
----

.Template placeholders
|===
|Placeholder|Example|Description

| {link}
| items-id
| Derived from the documentation string. For example: `items/id`.

| {title}
| Get Item By Id
| Derived from method name. For example: `getItemById`.

| {snippets}
| target/generated-snippets
| Base snippet folder configured via `org.springframework.restdocs.outputDir` system property.

| {sections}
| <iterable>
| Contains all sections (Snippet classes) which are configured to be included in the section snippet. Moustache templater iterates over this and expands into separate header and link lines.

| {header}
| Authorization
| Snippet header hard-coded inside Snippet class.

| {fileName}
| authorization
| Snippet name hard-coded inside Snippet class.

|===

[[snippets-section-configuration]]
==== Snippet configuration

By default, these snippets in the following order are linked inside section snippet:

|===
| Snippet name|Example|Description
| method-path
| `POST /items/{id}`
| (Non-configurable) link:{core-package}/misc/MethodAndPathSnippet.java[MethodAndPathSnippet] is used to determine the HTTP method and path.

| description
| Get an item by its ID.
| (Non-configurable) link:{core-package}/misc/DescriptionSnippet.java[DescriptionSnippet] reads the Javadoc on the method.

| authorization
| Resource is public.
| link:{core-package}/misc/AuthorizationSnippet.java[AuthorizationSnippet] can be used for custom authorization information, e.g. the OAuth role required for the endpoint

| path-parameters
| <table>
| link:{core-package}/request/PathParametersSnippet.java[PathParametersSnippet] automatically lists parameters in the path including their type, whether they are optional, and their Javadoc.

| request-parameters
| <table>
| link:{core-package}/request/RequestParametersSnippet.java[RequestParametersSnippet] automatically lists query parameters including their type, whether they are optional, and their Javadoc.

| request-fields
| <table>
| link:{core-package}/payload/JacksonRequestFieldSnippet.java[JacksonRequestFieldSnippet] automatically lists all fields of the request body including their type, whether they are optional, and their Javadoc.

| response-fields
| <table>
| link:{core-package}/payload/JacksonResponseFieldSnippet.java[JacksonResponseFieldSnippet] automatically lists all fields of the response body including their type, whether they are optional, and their Javadoc.

| curl-request
| `$ curl 'http://localhost/items/1'`
| The original link:{restdocs-package}/cli/CurlRequestSnippet.java[CurlRequestSnippet] from Spring REST Docs is used here to provide a cURL example of the request.

| http-response
| `HTTP/1.1 200 OK +
   { id: "myId", ... }`
| The original link:{restdocs-package}/http/HttpResponseSnippet.java[HttpResponseSnippet] from Spring REST Docs is used here to provide the HTTP response from the test.

|===

If you want to configure custom sections and their order, instead of using `AutoDocumentation.section()` you can use
 `AutoDocumentation.sectionBuilder()` in the following manner:

.Configuring section snippet
[source,java,indent=0,role="secondary"]
----
AutoDocumentation.sectionBuilder()
    .snippetNames(
        SnippetRegistry.PATH_PARAMETERS,
        SnippetRegistry.REQUEST_PARAMETERS,
        SnippetRegistry.REQUEST_FIELDS,
        SnippetRegistry.RESPONSE_FIELDS)
    .skipEmpty(true) <2>
    .build()
----
<1> only selected snippets will be used in the specified order
<2> whether snippets having no content should be skipped from section

==== Custom snippet

Custom snippets are created by subclassing a link:{restdocs-package}/snippet/Snippet.java[Snippet] interface
(or more conveniently link:{restdocs-package}/snippet/TemplatedSnippet.java[TemplatedSnippet]). If you want your custom
 snippet to be part of section snippet and automatically recognised header and include link (file name),
 you have to implement link:{core-package}/section/SectionSupport.java[SectionSupport] interface.
 Then, inside MockMvc configuration, add this snippet to the list of snippets using documentation configuration's
 builder `withDefaults(...)` and include snippet name among SectionBuilder's `snippetNames(...)`.